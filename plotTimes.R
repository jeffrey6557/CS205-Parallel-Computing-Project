plotTimes = function(data, labels){
  plot(data[1,], pch = 16, col = 1:ncol(data), ylim = c(0, max(data)), 
       xaxt = "n", xlab = "", ylab = "Time in seconds", xlim = c(0.5,ncol(data)+.5), 
       main = "Running time with 95% CI" )
  axis(side = 1, at = 1:ncol(data), labels = labels, tick = F, las = 2)
  for (i in 1:ncol(data)){
    if (i < ncol(data)){abline(v = i+.5, lty = 2)}
    segments(i,data[2,i],i,data[3,i], col = i)
    segments(i-.02,data[2:3,i],i+.02,data[2:3,i], col = i)
  }
}

# Exercise 2 (Adam?)
seq = c(18.5330983472,11.0279892445, 30.1942003429)
openMP = c(14.9100168781, 9.60147128105, 26.312218219)
pycuda = c(7.50733185935, 4.52090799212, 13.1926374018)
data = cbind(seq, openMP, pycuda)

png("images/adam_time.png")
plotTimes(data, labels = c("Sequential", "OpenMP", "PyCuda"))
dev.off()

# Exercise 4 (Hessian-Free)
adagrad = c(22.11327004, 20.99232507, 20.67294908, 21.50551796, 20.75233102,
22.05125189, 21.38181114, 23.677526, 22.23660803, 22.30888796,
14.05756593, 18.08011985, 19.73524594, 22.54485297, 17.04361391,
22.02792001, 22.47860503, 20.608922, 21.00822711, 23.78029704,
21.42607212, 21.29130912, 20.53942299, 21.21694303, 22.57947993,
21.95840693, 24.32899284, 22.9603219,  22.87017012, 21.20456409,
21.90778995, 21.08343601, 21.50300503, 21.53422499, 13.81168413,
22.60522199, 19.88480997, 7.45160484, 19.97562003, 20.16937613,
20.27532506, 22.59281611, 16.26733088, 16.46365118, 16.29503918,
23.00759101, 26.50316787, 22.54556799, 22.93052983, 24.2192111, 20.99614,
23.31750512, 21.214499, 21.41280198, 21.38578701, 10.68650699,
22.892905, 20.91852498, 21.82952499, 23.821877, 23.5960412,
18.76557589, 21.46441102, 21.42458797, 21.77034688, 17.06581402,
22.19701409, 24.07997298, 26.86816216, 23.07671595, 22.20187902,
23.25679016, 23.27407503, 23.405653, 22.63115716, 23.38570499,
14.93108296, 21.98823094, 15.65240216, 23.34415507, 22.76237607,
14.55085206, 21.06373596, 23.20424914, 25.40794516, 19.02210116,
20.89142084, 22.88376904, 23.03055191, 22.05191588, 22.41539788,
21.63741899, 18.83792615, 21.52511191, 14.34979415, 21.65945911,
21.15891695, 21.192698, 21.48585892, 21.53771591)
hessian = c(12.0897491,  15.61970711, 16.73269105, 19.51019096, 12.57617712
            , 14.30676794, 19.97101283, 12.46764612, 14.41777802, 20.47156787
            , 15.16088295, 16.49967599, 12.83834004, 16.83595586, 12.79600692
            , 14.84608483, 12.43463302, 24.49118304, 11.70132303, 11.72675514
            , 11.18041396, 13.03090405, 12.49246407, 11.98750997, 14.23958588
            , 12.627985, 13.04756689, 12.02765989, 14.80588412, 12.95769,  12.39289188
            , 13.09264302, 13.43699598, 14.73765588, 11.33010721, 14.18877387
            , 12.63954496, 14.23659706, 11.44752288, 12.1742332,  13.72819901
            , 12.45664597, 17.12006998, 13.27799797, 12.5478251,  12.19316697
            , 14.44936299, 13.38547301, 16.3413589,  13.98735404, 11.17660403
            , 12.23527002, 12.9973259,  11.66814017, 13.17126703, 21.08877897
            , 13.34077692, 12.88290191, 18.08759594, 13.1812551,  10.22021389
            , 12.41685104, 11.50975013, 14.88097692, 12.4733901,  11.89593887
            , 14.9053781,  24.47285509, 13.98910499, 12.035923, 11.21567106
            , 13.971596, 14.24634814, 10.08802986, 11.74070501, 13.17543507
            , 11.14087105, 11.11139202, 11.76184797, 10.25734997, 13.70303202
            , 10.20409799, 11.68141794, 10.63993907, 12.52129793, 10.40049887
            , 14.13986397, 12.14019012, 13.81961083, 14.84065795, 21.051018
            , 12.96687102, 15.11099696, 24.83531904, 10.28632212, 11.60003114
            , 16.04657006, 11.84397697, 12.37280583, 14.63371396)

adagrad = c(mean(adagrad), mean(adagrad)+sd(adagrad)*qnorm(c(0.025,0.975)))
hessian = c(mean(hessian), mean(hessian)+sd(hessian)*qnorm(c(0.025,0.975)))
seq = c(28.1367368197, 13.5122228265, 47.9142556608)
openMP16 = c(41.0403354907, 21.6629123032, 69.8737324953)
openMP64 = c(40.8446625209, 19.3463171542, 72.0430283785)
cuda = c(21.002744205, 11.5748599172, 38.3353739738)
ex2 = cbind(adagrad, hessian, seq, openMP16, openMP64, cuda)

png("experiment_4.png")
plotTimes(ex2, c("AdaGrad", "Hessian\nfree", "Sequential", "OpenMP\n16 cores", "OpenMP\n64 cores", "PyCuda"))
dev.off()