library(ggplot2)


#### Experiment 2
# Cuda
cuda_loss = c(4.1864476875070498, 1.865434858882016, 1.3818578036667259, 1.2421049187369453, 1.2219228250183762, 1.1873860242316081, 1.1846561050447364, 1.1710844644701346, 1.1613778645745194, 1.1493520467384983, 1.1486139531994601, 1.1486329878652393, 1.1475968786482387, 1.1430827979061242, 1.1375225084927636, 1.134093707839813, 1.1387619425528999, 1.1353218764150035, 1.1320594642265562, 1.1284367749675048, 1.1269697379726504, 1.1305691111583789, 1.1270616333844874, 1.125361624011326, 1.1253850482175052, 1.1243962485015861, 1.1191883372933205, 1.1238793118627746, 1.1193141058414389, 1.1171560023823144, 1.1182097850154187, 1.121804613509872, 1.1199013876335144, 1.1185683033323097, 1.11573777934897, 1.1236124903395484, 1.1206623345307904, 1.1186482728350902, 1.1164625420447942, 1.1176355209060467, 1.1155702649067138, 1.1163384416640567, 1.1138471192287678, 1.1146196820818564, 1.1126506529201059, 1.1180572273488592)
cuda_valLoss = c(2.0072012491365161, 1.3308836910046791, 1.1898811319972329, 1.1591923007800271, 1.1440527465374983, 1.1353673947055394, 1.1289888098861194, 1.1249343452515015, 1.1217366368113757, 1.119602660290955, 1.1173755876980003, 1.115369172348325, 1.1127866855196047, 1.1114358811086009, 1.1102419876317096, 1.1093661824310079, 1.1086304077492937, 1.1080767201068482, 1.1072314161641927, 1.1065888436355256, 1.1064304149340711, 1.1061709708013765, 1.1057600138026631, 1.1053760534462302, 1.1051187629984096, 1.1049061889609657, 1.1045773320584247, 1.1044010352942952, 1.1041781333938205, 1.1039768766847879, 1.1040470477323618, 1.1038473329880165, 1.1037193452330292, 1.1038674158954653, 1.1037646391479818, 1.1035288130780552, 1.1033619298081767, 1.1033607140430877, 1.1032467167565718, 1.1029506714939465, 1.1032993165730056, 1.103365499138711, 1.1034709673661451, 1.1030613779011762, 1.1030195132630107, 1.1031193078392363)

# OpenMP
mp_loss = c(3.409805499328495, 2.0337079029125276, 1.5451913123595069, 1.3552936724298799, 1.2728972357518087, 1.2456961537900491, 1.2316137226887975, 1.2183489820258353, 1.2080618803071406, 1.209092546010379, 1.2028831474236155, 1.2034926415297875, 1.2009666071696945, 1.2045347089788063, 1.195355041361837, 1.1905411621764821, 1.1889835069183778, 1.1995746627337609, 1.1877190333818461, 1.1885992504764276, 1.1906814916074686, 1.1869440702510763, 1.1869371517079734, 1.1860882184857202, 1.1865020210930235, 1.1835623651467666, 1.188523046122437, 1.1839494765506904, 1.1849036131478115, 1.1829119670917378, 1.1842800715335111, 1.1825723377246693, 1.183171790703385, 1.1805147800533642, 1.1816079980912284, 1.1821375514893055, 1.1822203703123011, 1.1821855230560121, 1.1812465252204321, 1.1794313417936864, 1.1799459516441466, 1.1786493128027495, 1.1781632999183465, 1.1799440962633292, 1.1802756407484949, 1.1817571476610744, 1.1770997101316492, 1.1797952996796546, 1.1784367299708216, 1.1781393873541044, 1.1803253505121054, 1.1778135736274897, 1.17867548796456, 1.1754595773440883, 1.1750561496623744, 1.17803274252265, 1.1777494710417644, 1.1766771836438812, 1.1766679941794698, 1.1781972104356953, 1.175555417132816)
mp_valLoss = c(1.6298283404392615, 1.1753905509254239, 1.0176372539993062, 0.96532787597207692, 0.94844931893250128, 0.93913087762844272, 0.93368505748883213, 0.92997611132527724, 0.92775612275748287, 0.92558836551166634, 0.92390562521728647, 0.92244193338612623, 0.92123467826875582, 0.92038285499990935, 0.91966368708922397, 0.91918197535773694, 0.91854219077522981, 0.91785437923009339, 0.91724137250385784, 0.91675353635977341, 0.91634755355145958, 0.91588754215227552, 0.91546032284122936, 0.91510684419106481, 0.91476105587315215, 0.91440118710415441, 0.91397016953711019, 0.91352496006576867, 0.91319743603700221, 0.91291421910376114, 0.91271834276927122, 0.91251468274683034, 0.91230674486409125, 0.91215694978737261, 0.91195519406364878, 0.91176568359005294, 0.91164710373443814, 0.91148649137410342, 0.91132126241084155, 0.91123368906918234, 0.91115821116821361, 0.91109546341357983, 0.91103248408752879, 0.91096566063555484, 0.91087319096723918, 0.91079049476402485, 0.91066640074153704, 0.91058353788365509, 0.91054786495821471, 0.91045686744989196, 0.91035037323888057, 0.91032888888504815, 0.91033884744569837, 0.91021277530037403, 0.91016925783005453, 0.91026072373272238, 0.91040968139548906, 0.9103988734434032, 0.91033606786155896, 0.91030691268685626, 0.91032514469941084)

# Sequential
seq_loss = c(1.467226750576399, 1.2566617127965094, 1.227592972155267, 1.2063684877415637, 1.2040074260884357, 1.1987919677176107, 1.195884505251702, 1.1942001514571061, 1.1928672649287668, 1.1912332596730071, 1.1906490482401726, 1.1898255327043974, 1.1881590711205123, 1.1873432976330316, 1.1864135233988558, 1.1846658958874683, 1.1859736825636416, 1.1847755152395998, 1.1833160954726913, 1.1839680973678477, 1.1829111040301279, 1.1826227560994866, 1.1832826983235067, 1.1810990721456731, 1.1819049749174324, 1.1832260668327472, 1.1809163726262988, 1.1814110681224557, 1.1826615873223409, 1.1804102148464801)
seq_valLoss = c(0.49481278140265078, 0.4828631561382713, 0.47873092350538515, 0.47714450719708779, 0.47593886872077135, 0.47548079597033238, 0.47470596324081243, 0.47446334693730829, 0.4734875054622848, 0.47340528397491588, 0.47356588049924275, 0.47305363278632251, 0.47291309655212055, 0.47234009637566954, 0.47238303021720107, 0.47201324318371385, 0.47175889297041934, 0.47107977597056239, 0.47140009451055387, 0.47114632521214178, 0.47151265656474695, 0.47179093542625822, 0.47136645322030818, 0.47096903368299836, 0.47119108865358678, 0.47133221030925487, 0.47207262944999778, 0.47115223205233292, 0.47120055307217201, 0.47126707351627534)

n = max(length(cuda_loss), length(mp_loss), length(seq_loss))
epochs = 1:n
cuda_loss = c(cuda_loss, rep(NA,n-length(cuda_loss))); cuda_valLoss = c(cuda_valLoss, rep(NA,n-length(cuda_valLoss)))
mp_loss = c(mp_loss, rep(NA,n-length(mp_loss))); mp_valLoss = c(mp_valLoss, rep(NA,n-length(mp_valLoss)))
seq_loss = c(seq_loss, rep(NA,n-length(seq_loss))); seq_valLoss = c(seq_valLoss, rep(NA,n-length(seq_valLoss)))

### Plot training loss
png("images/ex2_trainingLoss_plot.png")
plot(epochs, seq_loss, type = "l", lwd = 2, ylim = c(min(cuda_loss, seq_loss, mp_loss, na.rm = T), 
                                                     max(cuda_loss, seq_loss, mp_loss, na.rm = T)),
     xlab = "Number of Epoch", ylab = "Training Loss", main = "Experiment 2")
lines(epochs, cuda_loss, col = 2, lwd = 2)
lines(epochs, mp_loss, col = 3, lwd = 2)
legend("topright", legend = c("Sequential","Cuda","OpenMP"), col = 1:3, lwd = 2)
dev.off()

### Plot validation loss
png("images/ex2_validationLoss_plot.png")
plot(epochs, seq_valLoss, type = "l", lwd = 2, ylim = c(min(cuda_valLoss, seq_valLoss, mp_valLoss, na.rm = T), 
                                                     max(cuda_valLoss, seq_valLoss, mp_valLoss, na.rm = T)),
     xlab = "Number of Epoch", ylab = "Validation Loss")
lines(epochs, cuda_valLoss, col = 2, lwd = 2)
lines(epochs, mp_valLoss, col = 3, lwd = 2)
legend("topright", legend = c("Sequential","Cuda","OpenMP"), col = 1:3, lwd = 2)
dev.off()

### Plot confidence intervals
xlabs = c("Accuracy", "Hit Ratio")
model1Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(0.526206383587, 0.481200997221),
                          LowBound = c(0.447980097266, 0.360623058689),
                          UpBound = c(0.578286811884,0.606076303744),
                          Algorithm = "Sequential algorithm")
model2Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(0.498477323571, 0.474662530513),
                          LowBound = c(0.487695749441, 0.299806753458),
                          UpBound = c(0.509055318284,0.613303498779),
                          Algorithm = "OpenMP")
model3Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(0.497902989628, 0.477295362083),
                          LowBound = c(0.488097417124, 0.315439381611),
                          UpBound = c(0.508445190157,0.614732506103),
                          Algorithm = "CUDA")
# Combine these data.frames
allModelFrame <- data.frame(rbind(model1Frame, model2Frame, model3Frame))  # etc.

# Plot
png("images/ex2_accuracyAndHitRatio.png")
zp1 <- ggplot(allModelFrame, aes(colour = Algorithm))
zp1 <- zp1 + geom_hline(yintercept = 1, colour = gray(1/2), lty = 2)
zp1 <- zp1 + geom_linerange(aes(x = Metrics, ymin = LowBound, ymax = UpBound),
                            lwd = 1, position = position_dodge(width = 1/2))
zp1 <- zp1 + geom_pointrange(aes(x = Metrics, y = Estimate, ymin = LowBound,
                                 ymax = UpBound),
                             lwd = 1/2, position = position_dodge(width = 1/2),
                             shape = 21, fill = "WHITE")
zp1 <- zp1 + coord_flip() + theme_bw()
zp1 <- zp1 + ggtitle("Comparison of Algorithms")
print(zp1)
dev.off()

# MSE and MAE
xlabs = c("Mean square error", "Mean absolute error")
model1Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(1.3087405831, 0.718717655156),
                          LowBound = c(0.834318048764, 0.498239329293),
                          UpBound = c(3.23088638137,1.33780171462),
                          Algorithm = "Sequential algorithm")
model2Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(2.31100024114, 0.921309528683),
                          LowBound = c(0.838316850733, 0.525500713845),
                          UpBound = c(11.6191188956,2.56798020843),
                          Algorithm = "OpenMP")
model3Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(2.49617803848, 0.954769175157),
                          LowBound = c(0.840065719306, 0.526726699958),
                          UpBound = c(11.616296602,2.60011201977),
                          Algorithm = "CUDA")

allModelFrame <- data.frame(rbind(model1Frame, model2Frame, model3Frame))
png("images/ex2_MSEandMAE.png")
zp1 <- ggplot(allModelFrame, aes(colour = Algorithm))
zp1 <- zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 <- zp1 + geom_linerange(aes(x = Metrics, ymin = LowBound, ymax = UpBound),
                            lwd = 1, position = position_dodge(width = 1/2))
zp1 <- zp1 + geom_pointrange(aes(x = Metrics, y = Estimate, ymin = LowBound,
                                 ymax = UpBound),
                             lwd = 1/2, position = position_dodge(width = 1/2),
                             shape = 21, fill = "WHITE")
zp1 <- zp1 + coord_flip() + theme_bw()
zp1 <- zp1 + ggtitle("Comparison of Algorithms")
print(zp1)
dev.off()

#### Experiment 3
# Cuda
cuda_loss = c(4.1864476875070498, 1.865434858882016, 1.3818578036667259, 1.2421049187369453, 1.2219228250183762, 1.1873860242316081, 1.1846561050447364, 1.1710844644701346, 1.1613778645745194, 1.1493520467384983, 1.1486139531994601, 1.1486329878652393, 1.1475968786482387, 1.1430827979061242, 1.1375225084927636, 1.134093707839813, 1.1387619425528999, 1.1353218764150035, 1.1320594642265562, 1.1284367749675048, 1.1269697379726504, 1.1305691111583789, 1.1270616333844874, 1.125361624011326, 1.1253850482175052, 1.1243962485015861, 1.1191883372933205, 1.1238793118627746, 1.1193141058414389, 1.1171560023823144, 1.1182097850154187, 1.121804613509872, 1.1199013876335144, 1.1185683033323097, 1.11573777934897, 1.1236124903395484, 1.1206623345307904, 1.1186482728350902, 1.1164625420447942, 1.1176355209060467, 1.1155702649067138, 1.1163384416640567, 1.1138471192287678, 1.1146196820818564, 1.1126506529201059, 1.1180572273488592)
cuda_valLoss = c(2.0072012491365161, 1.3308836910046791, 1.1898811319972329, 1.1591923007800271, 1.1440527465374983, 1.1353673947055394, 1.1289888098861194, 1.1249343452515015, 1.1217366368113757, 1.119602660290955, 1.1173755876980003, 1.115369172348325, 1.1127866855196047, 1.1114358811086009, 1.1102419876317096, 1.1093661824310079, 1.1086304077492937, 1.1080767201068482, 1.1072314161641927, 1.1065888436355256, 1.1064304149340711, 1.1061709708013765, 1.1057600138026631, 1.1053760534462302, 1.1051187629984096, 1.1049061889609657, 1.1045773320584247, 1.1044010352942952, 1.1041781333938205, 1.1039768766847879, 1.1040470477323618, 1.1038473329880165, 1.1037193452330292, 1.1038674158954653, 1.1037646391479818, 1.1035288130780552, 1.1033619298081767, 1.1033607140430877, 1.1032467167565718, 1.1029506714939465, 1.1032993165730056, 1.103365499138711, 1.1034709673661451, 1.1030613779011762, 1.1030195132630107, 1.1031193078392363)

# OpenMP
mp_loss = c(3.409805499328495, 2.0337079029125276, 1.5451913123595069, 1.3552936724298799, 1.2728972357518087, 1.2456961537900491, 1.2316137226887975, 1.2183489820258353, 1.2080618803071406, 1.209092546010379, 1.2028831474236155, 1.2034926415297875, 1.2009666071696945, 1.2045347089788063, 1.195355041361837, 1.1905411621764821, 1.1889835069183778, 1.1995746627337609, 1.1877190333818461, 1.1885992504764276, 1.1906814916074686, 1.1869440702510763, 1.1869371517079734, 1.1860882184857202, 1.1865020210930235, 1.1835623651467666, 1.188523046122437, 1.1839494765506904, 1.1849036131478115, 1.1829119670917378, 1.1842800715335111, 1.1825723377246693, 1.183171790703385, 1.1805147800533642, 1.1816079980912284, 1.1821375514893055, 1.1822203703123011, 1.1821855230560121, 1.1812465252204321, 1.1794313417936864, 1.1799459516441466, 1.1786493128027495, 1.1781632999183465, 1.1799440962633292, 1.1802756407484949, 1.1817571476610744, 1.1770997101316492, 1.1797952996796546, 1.1784367299708216, 1.1781393873541044, 1.1803253505121054, 1.1778135736274897, 1.17867548796456, 1.1754595773440883, 1.1750561496623744, 1.17803274252265, 1.1777494710417644, 1.1766771836438812, 1.1766679941794698, 1.1781972104356953, 1.175555417132816)
mp_valLoss = c(1.6298283404392615, 1.1753905509254239, 1.0176372539993062, 0.96532787597207692, 0.94844931893250128, 0.93913087762844272, 0.93368505748883213, 0.92997611132527724, 0.92775612275748287, 0.92558836551166634, 0.92390562521728647, 0.92244193338612623, 0.92123467826875582, 0.92038285499990935, 0.91966368708922397, 0.91918197535773694, 0.91854219077522981, 0.91785437923009339, 0.91724137250385784, 0.91675353635977341, 0.91634755355145958, 0.91588754215227552, 0.91546032284122936, 0.91510684419106481, 0.91476105587315215, 0.91440118710415441, 0.91397016953711019, 0.91352496006576867, 0.91319743603700221, 0.91291421910376114, 0.91271834276927122, 0.91251468274683034, 0.91230674486409125, 0.91215694978737261, 0.91195519406364878, 0.91176568359005294, 0.91164710373443814, 0.91148649137410342, 0.91132126241084155, 0.91123368906918234, 0.91115821116821361, 0.91109546341357983, 0.91103248408752879, 0.91096566063555484, 0.91087319096723918, 0.91079049476402485, 0.91066640074153704, 0.91058353788365509, 0.91054786495821471, 0.91045686744989196, 0.91035037323888057, 0.91032888888504815, 0.91033884744569837, 0.91021277530037403, 0.91016925783005453, 0.91026072373272238, 0.91040968139548906, 0.9103988734434032, 0.91033606786155896, 0.91030691268685626, 0.91032514469941084)

# Sequential
seq_loss = c(1.467226750576399, 1.2566617127965094, 1.227592972155267, 1.2063684877415637, 1.2040074260884357, 1.1987919677176107, 1.195884505251702, 1.1942001514571061, 1.1928672649287668, 1.1912332596730071, 1.1906490482401726, 1.1898255327043974, 1.1881590711205123, 1.1873432976330316, 1.1864135233988558, 1.1846658958874683, 1.1859736825636416, 1.1847755152395998, 1.1833160954726913, 1.1839680973678477, 1.1829111040301279, 1.1826227560994866, 1.1832826983235067, 1.1810990721456731, 1.1819049749174324, 1.1832260668327472, 1.1809163726262988, 1.1814110681224557, 1.1826615873223409, 1.1804102148464801)
seq_valLoss = c(0.49481278140265078, 0.4828631561382713, 0.47873092350538515, 0.47714450719708779, 0.47593886872077135, 0.47548079597033238, 0.47470596324081243, 0.47446334693730829, 0.4734875054622848, 0.47340528397491588, 0.47356588049924275, 0.47305363278632251, 0.47291309655212055, 0.47234009637566954, 0.47238303021720107, 0.47201324318371385, 0.47175889297041934, 0.47107977597056239, 0.47140009451055387, 0.47114632521214178, 0.47151265656474695, 0.47179093542625822, 0.47136645322030818, 0.47096903368299836, 0.47119108865358678, 0.47133221030925487, 0.47207262944999778, 0.47115223205233292, 0.47120055307217201, 0.47126707351627534)

n = max(length(cuda_loss), length(mp_loss), length(seq_loss))
epochs = 1:n
cuda_loss = c(cuda_loss, rep(NA,n-length(cuda_loss))); cuda_valLoss = c(cuda_valLoss, rep(NA,n-length(cuda_valLoss)))
mp_loss = c(mp_loss, rep(NA,n-length(mp_loss))); mp_valLoss = c(mp_valLoss, rep(NA,n-length(mp_valLoss)))
seq_loss = c(seq_loss, rep(NA,n-length(seq_loss))); seq_valLoss = c(seq_valLoss, rep(NA,n-length(seq_valLoss)))

### Plot training loss
png("images/ex2_trainingLoss_plot.png")
plot(epochs, seq_loss, type = "l", lwd = 2, ylim = c(min(cuda_loss, seq_loss, mp_loss, na.rm = T), 
                                                     max(cuda_loss, seq_loss, mp_loss, na.rm = T)),
     xlab = "Number of Epoch", ylab = "Training Loss", main = "Experiment 2")
lines(epochs, cuda_loss, col = 2, lwd = 2)
lines(epochs, mp_loss, col = 3, lwd = 2)
legend("topright", legend = c("Sequential","Cuda","OpenMP"), col = 1:3, lwd = 2)
dev.off()

### Plot validation loss
png("images/ex2_validationLoss_plot.png")
plot(epochs, seq_valLoss, type = "l", lwd = 2, ylim = c(min(cuda_valLoss, seq_valLoss, mp_valLoss, na.rm = T), 
                                                        max(cuda_valLoss, seq_valLoss, mp_valLoss, na.rm = T)),
     xlab = "Number of Epoch", ylab = "Validation Loss")
lines(epochs, cuda_valLoss, col = 2, lwd = 2)
lines(epochs, mp_valLoss, col = 3, lwd = 2)
legend("right", legend = c("Sequential","Cuda","OpenMP"), col = 1:3, lwd = 2)
dev.off()

### Plot confidence intervals
xlabs = c("Accuracy", "Hit Ratio")
model1Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(0.526206383587, 0.481200997221),
                          LowBound = c(0.447980097266, 0.360623058689),
                          UpBound = c(0.578286811884,0.606076303744),
                          Algorithm = "Sequential algorithm")
model2Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(0.498477323571, 0.474662530513),
                          LowBound = c(0.487695749441, 0.299806753458),
                          UpBound = c(0.509055318284,0.613303498779),
                          Algorithm = "OpenMP")
model3Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(0.497902989628, 0.477295362083),
                          LowBound = c(0.488097417124, 0.315439381611),
                          UpBound = c(0.508445190157,0.614732506103),
                          Algorithm = "CUDA")
# Combine these data.frames
allModelFrame <- data.frame(rbind(model1Frame, model2Frame, model3Frame))  # etc.

# Plot
png("images/ex2_accuracyAndHitRatio.png")
zp1 <- ggplot(allModelFrame, aes(colour = Algorithm))
zp1 <- zp1 + geom_hline(yintercept = 1, colour = gray(1/2), lty = 2)
zp1 <- zp1 + geom_linerange(aes(x = Metrics, ymin = LowBound, ymax = UpBound),
                            lwd = 1, position = position_dodge(width = 1/2))
zp1 <- zp1 + geom_pointrange(aes(x = Metrics, y = Estimate, ymin = LowBound,
                                 ymax = UpBound),
                             lwd = 1/2, position = position_dodge(width = 1/2),
                             shape = 21, fill = "WHITE")
zp1 <- zp1 + coord_flip() + theme_bw()
zp1 <- zp1 + ggtitle("Comparison of Algorithms")
print(zp1)
dev.off()

# MSE and MAE
xlabs = c("Mean square error", "Mean absolute error")
model1Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(1.3087405831, 0.718717655156),
                          LowBound = c(0.834318048764, 0.498239329293),
                          UpBound = c(3.23088638137,1.33780171462),
                          Algorithm = "Sequential algorithm")
model2Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(2.31100024114, 0.921309528683),
                          LowBound = c(0.838316850733, 0.525500713845),
                          UpBound = c(11.6191188956,2.56798020843),
                          Algorithm = "OpenMP")
model3Frame <- data.frame(Metrics = xlabs,
                          Estimate = c(2.49617803848, 0.954769175157),
                          LowBound = c(0.840065719306, 0.526726699958),
                          UpBound = c(11.616296602,2.60011201977),
                          Algorithm = "CUDA")

allModelFrame <- data.frame(rbind(model1Frame, model2Frame, model3Frame))
png("images/ex2_MSEandMAE.png")
zp1 <- ggplot(allModelFrame, aes(colour = Algorithm))
zp1 <- zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 <- zp1 + geom_linerange(aes(x = Metrics, ymin = LowBound, ymax = UpBound),
                            lwd = 1, position = position_dodge(width = 1/2))
zp1 <- zp1 + geom_pointrange(aes(x = Metrics, y = Estimate, ymin = LowBound,
                                 ymax = UpBound),
                             lwd = 1/2, position = position_dodge(width = 1/2),
                             shape = 21, fill = "WHITE")
zp1 <- zp1 + coord_flip() + theme_bw()
zp1 <- zp1 + ggtitle("Comparison of Algorithms")
print(zp1)
dev.off()

